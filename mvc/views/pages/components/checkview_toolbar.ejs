<!--COLLAPSE-->
<div class="col-auto  btn-check border-right border-secondary pl-1 pr-1"
     id="diff-toolbar-collapse"
     style="margin-top: 2px;"
>
    <a type="button"
       class="btn vcenter-item pl-0 pr-0 pt-0 pb-1 mb-0  rounded-0 dropdown-toggle-split "
       title="toggle toolbar"
       onclick="toggleSnapshotToolbarCollapse()"
    >
        <i class="bi bi-chevron-compact-right" id="snapshot-collapse-icon"></i>
    </a>
</div>
<div class="col-auto" id="snapshot-toolbar-buttons">
    <div class="row">
        <!--ZOOM IN-->
        <div class="col-auto btn-check pl-1 pr-1" onclick="mainView.zoom(15)">
            <a name="zoom in" type="button"
               class="vcenter-item pl-1 pr-1 pt-0 pb-0 mb-1 border-0 rounded"
               title="zoom in (+)"
            >
                <i class="bi bi-zoom-in"></i>
            </a>
        </div>
        <!--ZOOM OUT-->
        <div class="col-auto btn-check pl-1 pr-1">
            <a name="zoom-out" type="button"
               title="zoom out (-)"
               class="vcenter-item pl-1 pr-1 pt-0 pb-0 mb-1 border-0 rounded"
               onclick="mainView.zoom(-15)">
                <i class="bi bi-zoom-out"></i>
            </a>
        </div>

        <!--TOGGLE GRAB MODE-->
        <div class="col-auto btn-check pl-1 pr-1 pt-0" id="grab-wrapper"
             onclick="toggleButtonAsPressed('grab-wrapper'); currentMode.toggle('pan')">
            <a id="grab" type="button"
               title="grab the viewport (G)"
               class="vcenter-item pl-1 pr-1 pt-0 pb-0 mb-1 border-0 rounded"
            >
                <i class="far fa-hand-rock"></i>
            </a>
        </div>

        <!--TOGGLE DIFF-->
        <% if (actualSnapshot && diffSnapshot) { %>
            <div class="col-auto btn-check pl-1 pr-1 pt-0 border-left border-secondary" id="diff-wrapper"
                 onclick="mainView.toggleDiff({filename: '<%= diffSnapshot.filename; %>', id: '<%= diffSnapshot.id; %>', name: '<%= diffSnapshot.name; %>',createdDate: '<%= diffSnapshot.formattedCreatedDate; %>' })"
            >
                <a id="toggle-diff" type="button"
                   title="toggle diff (D)"
                   class="vcenter-item pl-0 pr-0 pt-0 pb-0 border-0"
                   style="margin-top: -2px;"
                >

                    <i class="bi bi-arrow-left-right"></i>
                </a>
            </div>
        <% } %>

        <!--ACTUAL VIEW-->
        <% if (actualSnapshot) { %>
            <div class="col-auto btn-check pl-1 pr-1 pt-0 border-secondary" id="actual-wrapper"
                 onclick="mainView.toggleActual(<%= JSON.stringify(actualSnapshot) %>);">
                <a id="toggle-actual-baseline" type="button"
                   title="switch to actual snapshot (current is baseline)"
                   class="vcenter-item pl-1 pr-1 pt-0 pb-0 border-0 noselect"
                   style="margin-top: -2px;"
                >
                    B
                </a>
            </div>
        <% } %>
        <!--SIDE TO SIDE VIEW-->
        <% if (actualSnapshot) { %>
            <div class="col-auto btn-check pl-1 pr-1 pt-0 border-right border-secondary" id="side-wrapper"
                 onclick="mainView.toggleSideToSideView();"
            >
                <a id="toggle-side" type="button"
                   title="toggle side by side view"
                   class="vcenter-item pl-1 pr-1 pt-0 pb-0 border-0 rounded"
                   style="margin-top: -2px;"
                >
                    <i class="bi bi-vr"></i>
                </a>
            </div>
        <% } %>

        <!--ADD IGNORE REGION-->
        <div class="col-auto btn-check pl-1 pr-1 pt-0"
             onclick="mainView.addIgnoreRegion( {name: 'ignore_rect', strokeWidth: 0,})">
            <a id="ignore-regions" type="button"
               title="add ignore region (A)"
               class="vcenter-item pl-1 pr-1 pt-0 pb-0 border-0 rounded"
            >
                <i class="bi bi-bounding-box"></i>
            </a>
        </div>
        <!--ADD BOUND REGIONS-->
<!--        <div class="col-auto btn-check pl-1 pr-1 border-secondary"-->
<!--             style="padding-top: 1px"-->
<!--        >-->
<!--            <a id="bound-regions" type="button"-->
<!--               class="vcenter-item pl-1 pr-1 pt-0 pb-0 mb-1 border-0 rounded"-->
<!--               title="add bound regions"-->
<!--               onclick="mainView.addBoundingRegion('bound_rect')"-->
<!--            >-->
<!--                <i class="bi bi-fullscreen"></i>-->
<!--            </a>-->
<!--        </div>-->
        <!--DELETE-->
        <div class="col-auto btn-check pl-1 pr-1 border-left border-secondary"
             style="padding-top: 1px"
             onclick="mainView.removeActiveIgnoreRegions()">
            <a id="delete-rect" type="button"
               class="vcenter-item pl-1 pr-1 pt-0 pb-0 mb-1 border-0 rounded"
               title="delete active region (Delete or Backspace)"

            >
                <i class="bi bi-trash"></i>
            </a>
        </div>
        <!--ACCEPT-->
        <div class="col-auto btn-check pl-0 pr-1 border-left1 border-secondary"
             style="margin-top: -1px"
             onclick="setTimeout(()=>{acceptAndRedirect2({
                     checkId: '<%= check.id %>',
                     actualId:  '<%= actualSnapshot.id %>',
                     expectedId:  '<%= baselineSnapshot.id %>',
                     testId:  '<%= test.id %>',
                     diffId: '<%= diffSnapshot?.id || baselineSnapshot?.id %>'
                     })}, 100);">
            <a id="accept-rect" type="button"
               class="vcenter-item pl-1 pr-1"
               style="margin-top: -1px"
               title="accept the actual snapshot as the baseline"

            >
                <% const isPrev = check.actualSnapshotId.toString() !== check.baselineId.toString() %>
                <% console.log(check.actualSnapshotId) %>
                <% console.log(check.baselineId) %>
                <% console.log({ isPrev }) %>
                <% if ((check.markedAs === 'accepted') && isPrev) { %>
                    <i class="bi bi-hand-thumbs-up" style="color: #06ba0e"></i>
                <% } else if((check.markedAs === 'accepted') && !isPrev){ %>
                    <i class="bi bi-hand-thumbs-up-fill" style="color: #06ba0e"></i>
                <% } else { %>
                    <i class="bi bi-hand-thumbs-up"></i>
                <% } %>

            </a>
        </div>

        <!--SAVE-->
        <div class="col-auto btn-check pl-1 pr-1 pr-1 border-left border-secondary"
             onclick="mainView.sendIgnoreRegions('<%= baselineSnapshot.id; %>' ,mainView.getRectData())">
            <a id="save-baseline" type="button"
               class="vcenter-item pl-1 pr-1 pt-0 pb-0 mb-1 border-0 rounded"
               title="save the baseline (S)"

            >
                <i class="bi bi-check2"></i>
            </a>
        </div>

        <!--IGNORE MENU-->
        <div name="ignore-menu"
             class="col-auto col-flex border-left border-right border-secondary  pl-0 pr-0 align-self-end"
             title="apply to the baseline one of ignore strategy"
        >
            <div class="dropdown">
                <button class="btn mb-1 text-dark dropdown-toggle btn-sm" type="button"
                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                        style="box-shadow: none; opacity: 1 !important;"
                >
                    <%= baselineSnapshot.matchType ? baselineSnapshot.matchType : 'antialiasing'; %>
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenu" style="z-index: 8888">
                    <a class="dropdown-item small" href="#"
                       onclick="setMatchType('antialiasing', '<%= baselineSnapshot.id; %>'); setTimeout(() => location.reload(), 500)">antialiasing</a>
                    <a class="dropdown-item small" href="#"
                       onclick="setMatchType('nothing',  '<%= baselineSnapshot.id; %>'); setTimeout(() => location.reload(), 500)">nothing</a>
                    <a class="dropdown-item small" href="#"
                       onclick="setMatchType('colors',  '<%= baselineSnapshot.id; %>'); setTimeout(() => location.reload(), 500)">colors</a>
                </div>
            </div>
        </div>

        <!--NAVIGATION-->
        <div class="col-auto btn-check pl-1 pr-1">
            <a type="button"
               id="navigation"
               class="vcenter-item pl-1 pr-1 pt-0 pb-0 mb-1 border-0 rounded dropdown-toggle-split"
               title="open other views" data-toggle="dropdown" aria-haspopup="true"
               aria-expanded="true">
                <i class="bi bi-grid-3x3-gap"></i>
            </a>
            <div class="dropdown-menu mr-0 dropdown-menu-right" aria-labelledby="navigation"
                 style="z-index: 10000">

                <!--DROPDOWN ITEMS-->
                <a name="group view" type="button"
                   class="btn btn-check vcenter-item pl-3 pr-1 pt-0 pb-0 mb-0 border-0 rounded-0"
                   onclick="window.location.href = '/checksgroupview?id=<%= check.id %>'"
                   title="Group view (checks with same idents in the same session)">
                    <img src="../../../../static/icons/group-view.svg" alt="group view"
                         class="pt-1 pr-1">
                    <span style="display: inline-block; margin-left: 3px">Group View</span>
                </a>
                <a id="check-info" type="button"
                   class="btn btn-check vcenter-item pl-3 pr-1 mt-2 pb-0 mb-0 border-0 rounded-0"
                   href="/check/<%=check.id%>"
                >
                    <i class="bi bi-info-circle"></i>
                   <span class="pl-2">Raw check info</span>
                </a>

                <div class="dropdown-divider"></div>

                <!--SCREENSHOTS-->
                <a target="_blank"
                   href="/snapshoots/<%= baselineSnapshot.filename ? baselineSnapshot.filename : (baselineSnapshot.id + '.png'); %>"
                   title="open the baseline screenshot file">
                    <img class="w-100 preview shadow mt-2"
                         src="/snapshoots/<%= baselineSnapshot.filename ? baselineSnapshot.filename : baselineSnapshot.id + '.png' %>"
                         alt="baseline">
                </a>
                <a class="dropdown-item text-center" style="font-size: 90%;"
                   target="_blank"
                   href="/snapshootview?id=<%= baselineSnapshot.id %>&diffid=<%= baselineSnapshot.id %>"
                >baseline file</a>

                <% if(actualSnapshot) { %>
                    <a target="_blank"
                       href="/snapshoots/<%= actualSnapshot.filename ? actualSnapshot.filename : (actualSnapshot.id + '.png'); %>"
                       title="open the baseline screenshot file">
                        <img class="w-100 preview shadow"
                             src="/snapshoots/<%= actualSnapshot.filename ? actualSnapshot.filename : actualSnapshot.id + '.png' %>"
                             alt="actual">
                    </a>
                    <a class="dropdown-item text-center" style="font-size: 90%;"
                       target="_blank"
                       href="/snapshoots/<%= actualSnapshot.filename ? actualSnapshot.filename : (actualSnapshot.id + '.png'); %>"
                    >actual file</a>
                <% } %>
            </div>
        </div>
    </div>
</div>
